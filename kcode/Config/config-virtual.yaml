# KCode é…ç½® - Virtual æ¨¡å¼ï¼ˆé»˜è®¤ï¼‰

app:
  name: "kcode"
  version: "2.0.0"
  workspace: "KCode"
  working_directory: "D:\\Repos\\kcode"
  header_welcome: "æ¬¢è¿å›æ¥ï¼"
  prompt_placeholder: "è¾“å…¥å‘½ä»¤ï¼Œä¾‹å¦‚ help"
  slogan: "ç°ä»£åŒ–å‘½ä»¤è¡Œ CNC æ§åˆ¶ç»ˆç«¯"
  suggestion_text: "Try \"/help\" to list commands."
  branch: "main"
  tokens: "0 tokens"
  permissions: "v2 mode"

transport:
  type: "virtual"

api:
  execute:
    description: "æ‰§è¡Œ G ä»£ç æˆ–å‘½ä»¤"
    request:
      text: "string"
    response:
      success: "bool"
      message: "string"

  stream_status:
    description: "è·å–æœºå™¨çŠ¶æ€æµ"
    stream: true
    response:
      x: "double"
      y: "double"
      z: "double"
      feed: "double"
      speed: "double"
      state: "string"
      alarm: "string"
      temp: "double"

commands:
  system:
    help:
      aliases: ["?", "h"]
      description: "æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯"
      action: "builtin:help"
    exit:
      aliases: ["quit", "q"]
      description: "é€€å‡ºç¨‹åº"
      action: "builtin:exit"
    status:
      aliases: ["st"]
      description: "æ˜¾ç¤ºæœºå™¨çŠ¶æ€"
      action: "builtin:status_panel"
    clear:
      aliases: ["cls"]
      description: "æ¸…å±"
      action: "builtin:clear"

  api:
    gcode:
      pattern: "^[GMgm]\\d+.*"
      endpoint: "execute"
      request_mapping:
        text: "$input"
      response_template: |
        {{if .success}}
        [green]?[/] {{.message}}
        {{else}}
        [red]?[/] {{.message}}
        {{end}}

    set:
      pattern: "^/set\\s+(\\w+)\\s+([\\d.]+)$"
      description: "è®¾ç½®å‚æ•° /set <é”®> <å€¼>"
      endpoint: "set_parameter"
      request_mapping:
        key: "$1"
        value: "$2"
      response_template: |
        {{if .success}}
        [green]âœ… å‚æ•°å·²æ›´æ–°[/]: {{.message}}
        {{else}}
        [red]âŒ è®¾ç½®å¤±è´¥[/]: {{.message}}
        {{end}}

    params:
      description: "æ˜¾ç¤ºæ‰€æœ‰å‚æ•°"
      endpoint: "get_parameters"

  macros:
    home:
      aliases: ["home_all", "å›é›¶"]
      description: "æ‰€æœ‰è½´å›é›¶"
      steps:
        - endpoint: "execute"
          request:
            text: "G28"
      response_template: "[green]ğŸ  å›é›¶å®Œæˆ[/]"

    zero_work:
      aliases: ["æ¸…é›¶"]
      description: "è®¾ç½®å½“å‰ä½ç½®ä¸ºå·¥ä»¶é›¶ç‚¹"
      steps:
        - endpoint: "execute"
          request:
            text: "G10 L20 P1 X0 Y0 Z0"
      response_template: "[green]ğŸ“ å·¥ä»¶é›¶ç‚¹å·²è®¾ç½®[/]"

    auto_probe:
      aliases: ["å¯¹åˆ€"]
      description: "è‡ªåŠ¨å¯¹åˆ€"
      steps:
        - endpoint: "execute"
          request:
            text: "G91 G38.2 Z-50 F50"
        - endpoint: "execute"
          request:
            text: "G90 G10 L20 P1 Z0"
        - endpoint: "execute"
          request:
            text: "G91 G0 Z5"
      response_template: "[green]ğŸ›  å¯¹åˆ€å®Œæˆ[/]"

  aliases:
    mv: "G0"
    rapid: "G0"
    feed: "G1"
